#include "vortex.h"


static constexpr float piece_value_table[vtx::_PIECE_TYPE_COUNT] = {
	 0.0f,
	 1.0f,  3.2f,  3.3f,  5.0f,  9.0f,  10'000.0f,
    -1.0f, -3.2f, -3.3f, -5.0f, -9.0f, -10'000.0f,
};

static constexpr float piece_position_table[vtx::_PIECE_TYPE_COUNT][8 * 8] = {
	{ // none
	},
	{ // white pawn
		0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f, 0.00f,
		0.50f,  0.50f,  0.50f,  0.50f,  0.50f,  0.50f,  0.50f, 0.50f,
		0.10f,  0.10f,  0.20f,  0.30f,  0.30f,  0.20f,  0.10f, 0.10f,
		0.05f,  0.05f,  0.10f,  0.25f,  0.25f,  0.10f,  0.05f, 0.05f,
		0.00f,  0.00f,  0.00f,  0.20f,  0.20f,  0.00f,  0.00f, 0.00f,
		0.05f, -0.05f, -0.10f,  0.00f,  0.00f, -0.10f, -0.05f, 0.05f,
		0.05f,  0.10f,  0.10f, -0.20f, -0.20f,  0.10f,  0.10f, 0.05f,
		0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f, 0.00f,
	},
	{ // white knight
		-0.50f, -0.40f, -0.30f, -0.30f, -0.30f, -0.30f, -0.40f, -0.50f,
		-0.40f, -0.20f,  0.00f,  0.00f,  0.00f,  0.00f, -0.20f, -0.40f,
		-0.30f,  0.00f,  0.10f,  0.15f,  0.15f,  0.10f,  0.00f, -0.30f,
		-0.30f,  0.05f,  0.15f,  0.20f,  0.20f,  0.15f,  0.05f, -0.30f,
		-0.30f,  0.00f,  0.15f,  0.20f,  0.20f,  0.15f,  0.00f, -0.30f,
		-0.30f,  0.05f,  0.10f,  0.15f,  0.15f,  0.10f,  0.05f, -0.30f,
		-0.40f, -0.20f,  0.00f,  0.05f,  0.05f,  0.00f, -0.20f, -0.40f,
		-0.50f, -0.40f, -0.30f, -0.30f, -0.30f, -0.30f, -0.40f, -0.50f,
	},
	{ // white bishop
		-0.20f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.20f,
		-0.10f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f, -0.10f,
		-0.10f,  0.00f,  0.05f,  0.10f,  0.10f,  0.05f,  0.00f, -0.10f,
		-0.10f,  0.05f,  0.05f,  0.10f,  0.10f,  0.05f,  0.05f, -0.10f,
		-0.10f,  0.00f,  0.10f,  0.10f,  0.10f,  0.10f,  0.00f, -0.10f,
		-0.10f,  0.10f,  0.10f,  0.10f,  0.10f,  0.10f,  0.10f, -0.10f,
		-0.10f,  0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.05f, -0.10f,
		-0.20f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.20f,
	},
	{ // white rook
		 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f,  0.00f,
		 0.05f, 0.10f, 0.10f, 0.10f, 0.10f, 0.10f, 0.10f,  0.05f,
		-0.05f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, -0.05f,
		-0.05f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, -0.05f,
		-0.05f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, -0.05f,
		-0.05f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, -0.05f,
		-0.05f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, 0.00f, -0.05f,
		 0.00f, 0.00f, 0.00f, 0.05f, 0.05f, 0.00f, 0.00f,  0.00f,
	},
	{ // white queen
		-0.20f, -0.10f, -0.10f, -0.05f, -0.05f, -0.10f, -0.10f, -0.20f,
		-0.10f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f, -0.10f,
		-0.10f,  0.00f,  0.05f,  0.05f,  0.05f,  0.05f,  0.00f, -0.10f,
		-0.05f,  0.00f,  0.05f,  0.05f,  0.05f,  0.05f,  0.00f, -0.05f,
		 0.00f,  0.00f,  0.05f,  0.05f,  0.05f,  0.05f,  0.00f, -0.05f,
		-0.10f,  0.05f,  0.05f,  0.05f,  0.05f,  0.05f,  0.00f, -0.10f,
		-0.10f,  0.00f,  0.05f,  0.00f,  0.00f,  0.00f,  0.00f, -0.10f,
		-0.20f, -0.10f, -0.10f, -0.05f, -0.05f, -0.10f, -0.10f, -0.20f,
	},
	{ // white king
		-0.40f, -0.40f, -0.35f, -0.35f, -0.35f, -0.35f, -0.40f, -0.40f,
		-0.30f, -0.30f, -0.25f, -0.25f, -0.25f, -0.25f, -0.30f, -0.30f,
		-0.30f, -0.25f, -0.10f, -0.10f, -0.10f, -0.10f, -0.25f, -0.30f,
		-0.30f, -0.25f, -0.05f, -0.05f, -0.05f, -0.05f, -0.25f, -0.30f,
		-0.25f, -0.20f,  0.00f,  0.00f,  0.00f,  0.00f, -0.20f, -0.25f,
		-0.20f, -0.15f,  0.00f,  0.05f,  0.05f,  0.00f, -0.15f, -0.20f,
		-0.05f, -0.05f,  0.00f,  0.00f,  0.00f,  0.00f, -0.05f, -0.05f,
		-0.15f,  0.00f, -0.10f, -0.15f, -0.15f, -0.10f,  0.00f, -0.15f,
	},
	{ // black pawn
		 0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,
		-0.05f, -0.10f, -0.10f,  0.20f,  0.20f, -0.10f, -0.10f, -0.05f,
		-0.05f,  0.05f,  0.10f,  0.00f,  0.00f,  0.10f,  0.05f, -0.05f,
		 0.00f,  0.00f,  0.00f, -0.20f, -0.20f,  0.00f,  0.00f,  0.00f,
		-0.05f, -0.05f, -0.10f, -0.25f, -0.25f, -0.10f, -0.05f, -0.05f,
		-0.10f, -0.10f, -0.20f, -0.30f, -0.30f, -0.20f, -0.10f, -0.10f,
		-0.50f, -0.50f, -0.50f, -0.50f, -0.50f, -0.50f, -0.50f, -0.50f,
		 0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,
	},
	{ // black knight
		 0.50f,  0.40f,  0.30f,  0.30f,  0.30f,  0.30f,  0.40f,  0.50f,
		 0.40f,  0.20f,  0.00f, -0.05f, -0.05f,  0.00f,  0.20f,  0.40f,
		 0.30f, -0.05f, -0.10f, -0.15f, -0.15f, -0.10f, -0.05f,  0.30f,
		 0.30f,  0.00f, -0.15f, -0.20f, -0.20f, -0.15f,  0.00f,  0.30f,
		 0.30f, -0.05f, -0.15f, -0.20f, -0.20f, -0.15f, -0.05f,  0.30f,
		 0.30f,  0.00f, -0.10f, -0.15f, -0.15f, -0.10f,  0.00f,  0.30f,
		 0.40f,  0.20f,  0.00f,  0.00f,  0.00f,  0.00f,  0.20f,  0.40f,
		 0.50f,  0.40f,  0.30f,  0.30f,  0.30f,  0.30f,  0.40f,  0.50f,
	},
	{ // black bishop
		 0.20f,  0.10f,  0.10f,  0.10f,  0.10f,  0.10f,  0.10f,  0.20f,
		 0.10f, -0.05f,  0.00f,  0.00f,  0.00f,  0.00f, -0.05f,  0.10f,
		 0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f,  0.10f,
		 0.10f,  0.00f, -0.10f, -0.10f, -0.10f, -0.10f,  0.00f,  0.10f,
		 0.10f, -0.05f, -0.05f, -0.10f, -0.10f, -0.05f, -0.05f,  0.10f,
		 0.10f,  0.00f, -0.05f, -0.10f, -0.10f, -0.05f,  0.00f,  0.10f,
		 0.10f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.10f,
		 0.20f,  0.10f,  0.10f,  0.10f,  0.10f,  0.10f,  0.10f,  0.20f,
	},
	{ // black rook
		 0.00f,  0.00f,  0.00f, -0.05f, -0.05f,  0.00f,  0.00f,  0.00f,
		 0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.05f,
		 0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.05f,
		 0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.05f,
		 0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.05f,
		 0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.05f,
		-0.05f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.10f, -0.05f,
		 0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,
	},
	{ // black queen
		 0.20f,  0.10f,  0.10f,  0.05f,  0.05f,  0.10f,  0.10f,  0.20f,
		 0.10f,  0.00f, -0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.10f,
		 0.10f, -0.05f, -0.05f, -0.05f, -0.05f, -0.05f,  0.00f,  0.10f,
		 0.00f,  0.00f, -0.05f, -0.05f, -0.05f, -0.05f,  0.00f,  0.05f,
		 0.05f,  0.00f, -0.05f, -0.05f, -0.05f, -0.05f,  0.00f,  0.05f,
		 0.10f,  0.00f, -0.05f, -0.05f, -0.05f, -0.05f,  0.00f,  0.10f,
		 0.10f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.00f,  0.10f,
		 0.20f,  0.10f,  0.10f,  0.05f,  0.05f,  0.10f,  0.10f,  0.20f,
	},
	{ // black king
		 0.15f,  0.00f,  0.10f,  0.15f,  0.15f,  0.10f,  0.00f,  0.15f,
		 0.05f,  0.05f,  0.00f,  0.00f,  0.00f,  0.00f,  0.05f,  0.05f,
		 0.20f,  0.15f,  0.00f, -0.05f, -0.05f,  0.00f,  0.15f,  0.20f,
		 0.25f,  0.20f,  0.00f,  0.00f,  0.00f,  0.00f,  0.20f,  0.25f,
		 0.30f,  0.25f,  0.05f,  0.05f,  0.05f,  0.05f,  0.25f,  0.30f,
		 0.30f,  0.25f,  0.10f,  0.10f,  0.10f,  0.10f,  0.25f,  0.30f,
		 0.30f,  0.30f,  0.25f,  0.25f,  0.25f,  0.25f,  0.30f,  0.30f,
		 0.40f,  0.40f,  0.35f,  0.35f,  0.35f,  0.35f,  0.40f,  0.40f,
	},
};

float vtx::Engine::static_eval(Board const& board)
{
	float evaluation = 0.0f;
	for (int i = 0; i < 64; i++)
	{
		evaluation += piece_value_table[board.pieces[i].type];
		evaluation += piece_position_table[board.pieces[i].type][i];
	}
	return evaluation;
}
